<!doctype html>
<html lang="fr" class="no-js" data-theme="auto">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Connexion â€¢ EnquÃªtes Politiques</title>
    <meta name="description" content="Page de connexion pour les enquÃªteurs politiques." />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='46' fill='%230090ff'/%3E%3Ctext x='50' y='58' font-size='44' text-anchor='middle' fill='white' font-family='Arial,Helvetica,sans-serif'%3EðŸ—³%3C/text%3E%3C/svg%3E"/>
    <style>
        /* ====== Base / Reset ====== */
        *,*::before,*::after{box-sizing:border-box}
        html,body{height:100%}
        body{margin:0;font-family: ui-sans-serif, -apple-system, Segoe UI, Roboto, Helvetica, Arial, system-ui, "Apple Color Emoji", "Segoe UI Emoji";line-height:1.5;color:var(--fg);background:var(--bg)}
        :root{
            --bg: #0b1020;
            --fg: #e8eef7;
            --muted: #a9b4c7;
            --card: rgba(255,255,255,0.06);
            --card-border: rgba(255,255,255,0.12);
            --brand: #3b82f6;
            --brand-600: #2563eb;
            --success: #10b981;
            --danger: #ef4444;
            --focus: 0 0 0 4px rgba(59,130,246,.35);
            --shadow-1: 0 10px 30px rgba(0,0,0,.35);
            --shadow-2: 0 4px 14px rgba(0,0,0,.3);
            --ring: rgba(59,130,246,.4);
            --input-bg: rgba(255,255,255,.06);
            --input-brd: rgba(255,255,255,.16);
        }
        @media (prefers-color-scheme: light){
            :root{
                --bg: #f3f6fb;
                --fg: #0f172a;
                --muted: #475569;
                --card: rgba(255,255,255,.88);
                --card-border: rgba(15,23,42,.08);
                --shadow-1: 0 10px 30px rgba(2,6,23,.08);
                --shadow-2: 0 4px 14px rgba(2,6,23,.06);
                --input-bg: rgba(2,6,23,.02);
                --input-brd: rgba(2,6,23,.12);
            }
        }

        /* ====== Background Art ====== */
        .bg{
            position: fixed; inset: 0; pointer-events: none; z-index: -1;
            background: radial-gradient(1200px 500px at 10% -10%, rgba(59,130,246,.35), transparent 60%),
            radial-gradient(1000px 400px at 120% 120%, rgba(16,185,129,.28), transparent 55%),
            linear-gradient(180deg, var(--bg), var(--bg));
            filter: saturate(110%);
        }
        .grid-center{min-height:100%; display:grid; place-items:center; padding:clamp(16px,3vw,40px)}

        /* ====== Card ====== */
        .card{width:100%; max-width:420px; background:var(--card); border:1px solid var(--card-border); border-radius:20px; box-shadow:var(--shadow-1); backdrop-filter: blur(10px)}
        .card-header{padding:28px 28px 0}
        .brand{display:flex; align-items:center; gap:12px}
        .brand-logo{width:40px; height:40px; display:grid; place-items:center; border-radius:12px; background:linear-gradient(145deg, var(--brand), var(--brand-600)); box-shadow:var(--shadow-2)}
        .brand h1{margin:0; font-size:clamp(18px,2.4vw,20px)}
        .subtitle{margin:8px 0 0; color:var(--muted); font-size:14px}

        .card-body{padding:24px 28px 28px}

        /* ====== Messages ====== */
        .messages {margin-bottom: 20px;}
        .alert {
            padding: 12px 16px;
            border-radius: 12px;
            margin-bottom: 12px;
            font-size: 14px;
            border: 1px solid;
        }
        .alert-error {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.3);
            color: #ef4444;
        }
        .alert-success {
            background: rgba(16, 185, 129, 0.1);
            border-color: rgba(16, 185, 129, 0.3);
            color: #10b981;
        }
        .alert-info {
            background: rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.3);
            color: #3b82f6;
        }

        /* ====== Form ====== */
        form{display:grid; gap:16px}
        .field{display:grid; gap:8px}
        label{font-weight:600; font-size:14px}
        .input{
            display:flex; align-items:center; gap:10px; width:100%;
            background:var(--input-bg); border:1px solid var(--input-brd); border-radius:12px; padding:12px 14px;
            transition: box-shadow .2s, border-color .2s, background .2s;
        }
        .input:focus-within{border-color:var(--brand); box-shadow: var(--focus)}
        .input input{flex:1; background:transparent; border:0; outline:0; color:var(--fg); font-size:15px}
        .input input::placeholder{color:rgba(127,143,164,.8)}
        .icon{width:20px; height:20px; opacity:.8}
        .toggle{cursor:pointer; border:0; background:transparent; padding:0; display:grid; place-items:center}

        .row{display:flex; justify-content:space-between; align-items:center; gap:12px}
        .checkbox{display:flex; align-items:center; gap:10px; font-size:14px; color:var(--muted)}
        .checkbox input{width:16px; height:16px}
        .link{color:var(--brand); text-decoration:none; font-weight:600}
        .link:hover{text-decoration:underline}

        .btn{display:inline-flex; justify-content:center; align-items:center; gap:10px; width:100%;
            padding:12px 16px; border-radius:12px; border:0; font-weight:700; cursor:pointer; transition: transform .02s ease, box-shadow .2s;
            background:linear-gradient(180deg, var(--brand), var(--brand-600)); color:#fff; box-shadow:0 6px 16px rgba(37,99,235,.35)
        }
        .btn:active{transform:translateY(1px)}
        .btn:disabled{opacity:0.6; cursor:not-allowed;}

        .divider{display:flex; align-items:center; gap:12px; color:var(--muted); font-size:13px}
        .divider::before,.divider::after{content:""; flex:1; height:1px; background:var(--card-border)}

        .footnote{margin-top:6px; font-size:12px; color:var(--muted)}

        /* ====== Animations ====== */
        @keyframes fadeUp{from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:translateY(0)}}
        .card{animation:fadeUp .34s ease both}

        /* ====== Accessibility ====== */
        :focus-visible{outline: none; box-shadow: var(--focus)}
        .sr-only{position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0}

        /* ====== Small tweaks ====== */
        .help{font-size:12px; color:var(--muted)}
        .loading {
            display: none;
        }
        .loading.active {
            display: inline-block;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
<div class="bg" aria-hidden="true"></div>
<main class="grid-center">
    <section class="card" aria-labelledby="heading-title">
        <header class="card-header">
            <div class="brand">
                <div class="brand-logo" aria-hidden="true">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z" stroke="white" stroke-width="1.5"/>
                    </svg>
                </div>
                <div>
                    <h1 id="heading-title">Ambassadeur</h1>
                    <p class="subtitle">Connectez-vous pour accÃ©der aux enquÃªtes</p>
                </div>
            </div>
        </header>

        <div class="card-body">
            <!-- Messages Django -->
            {% if messages %}
            <div class="messages">
                {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">
                    {{ message }}
                </div>
                {% endfor %}
            </div>
            {% endif %}

            <form id="loginForm" method="post" action="{% url 'login' %}" novalidate>
                {% csrf_token %}

                <div class="field">
                    <label for="email">Email</label>
                    <div class="input">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                            <path d="M4 6h16v12H4z" stroke="currentColor" stroke-width="1.5"/>
                            <path d="M4 8l8 5 8-5" stroke="currentColor" stroke-width="1.5"/>
                        </svg>
                        <input
                                id="email"
                                name="email"
                                type="email"
                                placeholder="votre.email@exemple.com"
                                autocomplete="email"
                                required
                                value="{{ request.POST.email|default:'' }}"
                        />
                    </div>
                    <p class="help" id="emailHelp">Utilisez l'email fourni par l'administrateur.</p>
                </div>

                <div class="field">
                    <div class="row" style="justify-content:space-between; align-items:end">
                        <label for="password">Mot de passe</label>
                        <a class="link" href="#" title="Contactez l'administrateur">Mot de passe oubliÃ© ?</a>
                    </div>
                    <div class="input">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                            <rect x="4" y="10" width="16" height="10" rx="2" stroke="currentColor" stroke-width="1.5"/>
                            <path d="M8 10V8a4 4 0 118 0v2" stroke="currentColor" stroke-width="1.5"/>
                        </svg>
                        <input
                                id="password"
                                name="password"
                                type="password"
                                placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                                autocomplete="current-password"
                                minlength="6"
                                required
                        />
                        <button type="button" class="toggle" aria-label="Afficher le mot de passe" id="togglePw">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path d="M1.5 12S5.5 4.5 12 4.5 22.5 12 22.5 12 18.5 19.5 12 19.5 1.5 12 1.5 12z" stroke="currentColor" stroke-width="1.5"/>
                                <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="1.5"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <div class="row">
                    <label class="checkbox">
                        <input type="checkbox" id="remember" name="remember" />
                        Se souvenir de moi
                    </label>
                </div>

                <button class="btn" type="submit" id="submitBtn">
                    <svg class="icon loading" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" fill="currentColor"/>
                    </svg>
                    <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M5 12h14M12 5l7 7-7 7" stroke="white" stroke-width="1.8" stroke-linecap="round"/>
                    </svg>
                    <span id="btnText">Se connecter</span>
                </button>
            </form>

            <div class="divider">
                <span>AccÃ¨s rÃ©servÃ© aux enquÃªteurs</span>
            </div>

            <div class="footnote" style="text-align: center;">
                <p style="margin: 0;">
                    <strong>PremiÃ¨re connexion ?</strong><br>
                    Contactez l'administrateur pour obtenir vos identifiants.
                </p>
            </div>
        </div>
    </section>
</main>

<script>
    // ====== Password toggle ======
    const pw = document.getElementById('password');
    const toggle = document.getElementById('togglePw');

    if (toggle && pw) {
        toggle.addEventListener('click', () => {
            const isPwd = pw.getAttribute('type') === 'password';
            pw.setAttribute('type', isPwd ? 'text' : 'password');
            toggle.setAttribute('aria-label', isPwd ? 'Masquer le mot de passe' : 'Afficher le mot de passe');
        });
    }

    // ====== Form submission with loading state ======
    const form = document.getElementById('loginForm');
    const email = document.getElementById('email');
    const submitBtn = document.getElementById('submitBtn');
    const btnText = document.getElementById('btnText');
    const loadingIcon = submitBtn.querySelector('.loading');
    const arrowIcon = submitBtn.querySelector('.icon:not(.loading)');

    if (form) {
        form.addEventListener('submit', (e) => {
            // Validation cÃ´tÃ© client
            if (!email.checkValidity() || !pw.checkValidity()) {
                e.preventDefault();
                form.reportValidity();
                return false;
            }

            // Ã‰tat de chargement
            submitBtn.disabled = true;
            btnText.textContent = 'Connexion...';
            loadingIcon.classList.add('active');
            arrowIcon.style.display = 'none';
        });

        // Auto-focus sur le premier champ vide
        if (email.value === '') {
            email.focus();
        } else if (pw.value === '') {
            pw.focus();
        }
    }

    // ====== Enhancement CSS class ======
    document.documentElement.classList.remove('no-js');

    // ====== Auto-hide messages aprÃ¨s 5 secondes ======
    const messages = document.querySelectorAll('.alert');
    messages.forEach(message => {
        if (!message.classList.contains('alert-error')) {
            setTimeout(() => {
                message.style.opacity = '0';
                message.style.transform = 'translateY(-10px)';
                setTimeout(() => message.remove(), 300);
            }, 5000);
        }
    });
</script>
</body>
</html>